(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{189:function(e,s,n){"use strict";n.r(s);var t=n(6),a=Object(t.a)({},(function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h3",{attrs:{id:"什么是hmr"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#什么是hmr"}},[e._v("#")]),e._v(" 什么是HMR")]),e._v(" "),n("p",[e._v("修改代码后，webpack重新打包，并将打包后的文件发送给浏览器，并替换浏览器的bundle,实现不刷新即可更新页面；")]),e._v(" "),n("h3",{attrs:{id:"webpack中热更新插件的实现步骤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#webpack中热更新插件的实现步骤"}},[e._v("#")]),e._v(" webpack中热更新插件的实现步骤")]),e._v(" "),n("p",[e._v("本质是利用Websocket服务器实现客户端代码和服务端代码的双向通信；\n看源码实现的大致步骤：")]),e._v(" "),n("ol",[n("li",[e._v("webpack-dev-server插件会在webpack的入口文件中添加两个文件，这两个文件会会打包到到最后的客户端的bundle中；")]),e._v(" "),n("li",[e._v("在webpack-dev-server的server部分会创建一个服务器，监听文件的变化如果有变化重新编译；")]),e._v(" "),n("li",[e._v("编译完成后会emit一个事件，客户端监听到这个事件，就触发重新render；")]),e._v(" "),n("li",[e._v("从而实现了浏览器无刷新的更新；")])]),e._v(" "),n("p",[e._v("这个插件结合了webpack编译过程，在编译过程中插入自己的逻辑代码；\n如果不用webpack的插件，其实也可以自己利用webSocket实现浏览器的自动刷新更新页面，思路和上面的大同小异；")]),e._v(" "),n("h3",{attrs:{id:"需要-刷新浏览器的自动热更新"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#需要-刷新浏览器的自动热更新"}},[e._v("#")]),e._v(" 需要    刷新浏览器的自动热更新")]),e._v(" "),n("p",[e._v("Node侧代码：")]),e._v(" "),n("ol",[n("li",[e._v("创建一个服务器，并创建一个socket连接")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const http = require(\"http\");\nconst socket = require('socket.io');\nlet refreshSocket = null;\n\nconst refreshSocketServer = require('http').createServer()\nlet io = socket(reloadSocketServer) // websocket协议的握手需要http服务器\n// 服务器需要监控客户端的连接，当客户端连接上来后，socket代表跟这个客户端连接的对象\nio.on('connect', socket => {\n  refreshSocket = socket;\n});\n// 断开链接的时候\nio.on('disconnect', (socket) => {\n  refreshSocket = null;\n});\nreFreshSocketServer.listen(3000);\n2. 监听client打包文件\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br"),n("span",{staticClass:"line-number"},[e._v("8")]),n("br"),n("span",{staticClass:"line-number"},[e._v("9")]),n("br"),n("span",{staticClass:"line-number"},[e._v("10")]),n("br"),n("span",{staticClass:"line-number"},[e._v("11")]),n("br"),n("span",{staticClass:"line-number"},[e._v("12")]),n("br"),n("span",{staticClass:"line-number"},[e._v("13")]),n("br"),n("span",{staticClass:"line-number"},[e._v("14")]),n("br"),n("span",{staticClass:"line-number"},[e._v("15")]),n("br"),n("span",{staticClass:"line-number"},[e._v("16")]),n("br")])]),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("chokidar.watch([\n  '/xx',\n], {\n    ignoreInitial: true\n}).on('all', (event, path) => {\n    refreshSocket.emit('reload'); // 通知客户端socket更新\n});\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br"),n("span",{staticClass:"line-number"},[e._v("6")]),n("br"),n("span",{staticClass:"line-number"},[e._v("7")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[e._v("客户端代码")])]),e._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import io from \"socket.io-client\";\nconst socket = io('127.0.0.1:3000/');// 连接服务端\n  socket.on('reload', () => {\n    window.location.reload();\n  })\n")])]),e._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[e._v("1")]),n("br"),n("span",{staticClass:"line-number"},[e._v("2")]),n("br"),n("span",{staticClass:"line-number"},[e._v("3")]),n("br"),n("span",{staticClass:"line-number"},[e._v("4")]),n("br"),n("span",{staticClass:"line-number"},[e._v("5")]),n("br")])]),n("p",[e._v("这样就实现了一个简单的浏览器自动刷新效果。")])])}),[],!1,null,null,null);s.default=a.exports}}]);